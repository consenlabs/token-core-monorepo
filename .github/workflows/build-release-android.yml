name: Build Android Release

on:
  pull_request_target:
    types: [assigned, opened, synchronize, reopened]

env:
  CARGO_TERM_COLOR: always    
  
jobs:

  build:
    name: Build Android Release
    runs-on: macos-latest
  
    steps:
    
    - name: Checkout repository
      uses: actions/checkout@v2
      with:
        ref: ${{ github.head_ref }}
        fetch-depth: 5

    - name: Cache
      uses: actions/cache@v2
      with:
        path: |
          ~/.cargo/registry
          ~/.cargo/git
          ~/.rustup
          target
        key: ${{ runner.os }}-nightly
          
    - name: Install Rust
      run: |
        echo 'NEXUS_USER=${{secrets.NEXUS_USER}}'
        echo 'NEXUS_PASSWORD=${{secrets.NEXUS_PASSWORD}}'
        echo 'github.head_ref'=${{ github.head_ref }}
        echo 'github.head_ref'=${{ github.head_ref }}
        echo 'github.event.pull_request.head.sha'=${{ github.event.pull_request.head.sha }}
        
      env:
        SLACK_WEBHOOK_URL: ${{ secrets.SLACK_WEBHOOK }}
        SLACK_WEBHOOK_TYPE: INCOMING_WEBHOOK